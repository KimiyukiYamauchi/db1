```sql
-- 使用するデータベースを指定
USE `chap07`;

DROP TABLE 個体識別;
-- 個体識別テーブル作成
CREATE TABLE 個体識別 (
  個体識別番号 CHAR(4) PRIMARY KEY,    -- 牛を一意に管理する番号
  出生日 DATE,                         -- 出生した日付
  雌雄コード CHAR(1),                  -- 性別（1: 雄、2: 雌）
  母牛番号 CHAR(4),                    -- 母牛の識別番号
  品種コード CHAR(2),                  -- 品種コード（01: 乳用種、02: 肉用種、03: 交雑種）
  飼育県 VARCHAR(10)                   -- 都道府県名
);

--- 個体識別テーブルにデータを追加
INSERT INTO 個体識別 (個体識別番号, 出生日, 雌雄コード, 母牛番号, 品種コード, 飼育県) VALUES
('B001', '2021-05-13', '2', NULL, '03', '北海道'),
('B002', '2020-08-20', '2', 'B001', '01', '北海道'),
('B003', '2021-01-23', '1', 'B001', '03', '北海道'),
('B004', '2021-06-02', '1', NULL, '03', '北海道'),
('B005', '2022-02-13', '2', 'B004', '02', '北海道'),
('B006', '2022-02-04', '1', 'B002', '02', '北海道'),
('B007', '2022-04-15', '1', 'B001', '03', '北海道'),
('B008', '2021-03-06', '1', 'B007', '02', '北海道'),
('B009', '2022-06-05', '1', 'B007', '02', '北海道'),
('B010', '2021-06-30', '1', NULL, '03', '北海道'),
('B011', '2021-05-28', '1', NULL, '03', '青森'),
('B012', '2022-03-04', '2', 'B007', '01', '青森'),
('B013', '2021-02-15', '1', 'B002', '03', '青森'),
('B014', '2022-01-03', '1', NULL, '03', '青森'),
('B015', '2020-12-03', '2', 'B007', '02', '青森'),
('B016', '2021-11-29', '2', 'B007', '01', '青森'),
('B017', '2020-10-30', '1', 'B006', '01', '青森'),
('B018', '2021-08-31', '2', NULL, '02', '青森'),
('B019', '2020-02-09', '1', 'B001', '01', '岩手'),
('B020', '2021-10-05', '1', 'B011', '01', '岩手'),
('B021', '2020-06-29', '2', 'B010', '02', '岩手'),
('B022', '2022-02-02', '2', 'B018', '02', '岩手'),
('B023', '2020-11-22', '1', 'B009', '03', '岩手'),
('B024', '2021-05-22', '1', 'B005', '03', '岩手'),
('B025', '2022-02-27', '2', 'B002', '01', '宮城'),
('B026', '2022-01-20', '2', NULL, '03', '宮城'),
('B027', '2022-05-29', '1', 'B012', '03', '秋田'),
('B028', '2022-01-10', '1', 'B026', '01', '秋田'),
('B029', '2020-05-01', '2', NULL, '01', '山形'),
('B030', '2021-11-11', '2', NULL, '01', '山形'),
('B031', '2021-07-27', '2', NULL, '02', '福島'),
('B032', '2022-06-21', '1', 'B028', '03', '福島'),
('B033', '2021-05-03', '2', 'B023', '02', '栃木'),
('B034', '2022-09-20', '2', 'B032', '02', '栃木'),
('B035', '2020-09-23', '2', 'B006', '01', '群馬'),
('B036', '2020-12-03', '1', 'B006', '02', '群馬');
--- 個体識別テーブルのデータの確認
select * from 個体識別;

DROP TABLE 頭数集計;
-- 頭数集計
CREATE TABLE 頭数集計 (
  飼育県 VARCHAR(20),  -- 牛を飼育している都道府県名
  頭数 INTEGER          -- 飼育している牛の数
);


```

## 問題

「chap07」データベース牛を個体識別番号で管理している個体識別テーブルがあります。このテーブルについて、指示されたSQL文を作成してください。  
  

### 問題１

飼育県別に飼育頭数を集計し、その結果を次の頭数集計テーブルに登録する。

| 列名  | データ型        | 備考            |
| --- | ----------- | ------------- |
| 飼育県 | VARCHAR(20) | 牛を飼育している都道府県名 |
| 頭数  | INTEGER     | 飼育している牛の数     |


### 問題２

問題1で作成した頭数集計テーブルで、飼育頭数の多いほうから3つの都道府県で飼育されている牛のデータを、個体識別テーブルより抽出する。抽出する項目は、都道府県名、個体識別番号、雌雄とする。ただし、雌雄はコードではなく「雄」「雌」の日本語表記とする。

### 問題３

個体識別テーブルには母牛についてもデータ登録されており、母牛が乳用種である牛の一覧を個体識別テーブルより抽出したい。抽出する項目は、個体識別番号、品種、出生日、母牛番号とする。ただし、品種はコードではなく「乳用種」「肉用種」「交雑種」の日本語表記とする。


---

「rpg」データベースの「パーティー」、「イベント」、「経験イベント」テーブルについて、以下の操作を行う、SQL 文を記述してください

### 問題４

これまでに着手していないイベントについて、イベント番号とその名称をイベント番号順に副問い合わせを用いて抽出する。列名はイベント番号、イベント名称。

### 問題５

これまでに着手していないイベントの数を副問い合わせを用いて抽出する。列名は未着手イベント数。

### 問題６

5番目にクリアしたイベントのイベント番号より小さい番号を持つすべてのイベントについて、イベント番号とイベント名称を抽出する。


### 問題７

これまでにパーティーがクリアしたイベントを前提としているイベントを次の形式で抽出する。
- イベント番号
- イベント名称
- 前提イベント番号

### 問題８

パーティーは、イベント番号「9」のイベントを結果「B」でクリアし、その次に発生するイベントに参加した。これを経験イベントテーブルに記録する。なお、更新と追加の両方を２つのSQL文で記述すること。(経験イベントテーブルに対する更新と追加)