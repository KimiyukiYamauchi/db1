## 問題

「chap06」データベースの「都市別気象観測」テーブルについて、以下の操作を行う、SQL 文を記述してください

### 問題1

データ全体の年間降水量の合計と、年間の最高気温・最低気温の平均、列名はそれぞれ年間降水量、最高気温平均、最低気温平均としてください。

```sql
SELECT SUM(降水量) AS 年間降水量,
       AVG(最高気温) AS 最高気温平均,
       AVG(最低気温) AS 最低気温平均
FROM 都市別気象観測;
```

#### 正解: 14 / 不正解: 3 / 正解率: 82%

### 問題2

都市名「那覇」の年間降水量の合計と、年間の最高気温・最低気温の平均、列名はそれぞれ年間降水量、最高気温平均、最低気温平均としてください。

```sql
SELECT SUM(降水量) AS 年間降水量,
       AVG(最高気温) AS 最高気温平均,
       AVG(最低気温) AS 最低気温平均
FROM 都市別気象観測
WHERE 都市名 = '那覇';
```

#### 正解: 13 / 不正解: 4 / 正解率: 76%

### 問題3

都市別の年間降水量の合計と、年間で、最も低かった最高気温、最も高かった最低気温、列名はそれぞれ都市名、年間降水量、最低最高気温、最高最低気温としてください。

```sql
SELECT 都市名,
       SUM(降水量) AS 年間降水量,
       MIN(最高気温) AS 最低最高気温,
       MAX(最低気温) AS 最高最低気温
FROM 都市別気象観測
GROUP BY 都市名;
```

#### 正解: 14 / 不正解: 3 / 正解率: 82%

### 問題4

月別の降水量の合計、最高気温、最低気温の平均、列名はそれぞれ月、月別降水量、月別最高気温平均、月別最低気温平均としてください。月の昇順で表示してください。

```sql
SELECT 月,
       SUM(降水量) AS 月別降水量,
       AVG(最高気温) AS 月別最高気温平均,
       AVG(最低気温) AS 月別最低気温平均
FROM 都市別気象観測
GROUP BY 月
ORDER BY 月;
```

#### 正解: 11 / 不正解: 6 / 正解率: 65%

### 問題5

都市別で、1年間で最も高い最高気温が30度以上を記録した月のある都市名とその気温。列名は都市名、最高気温(30度以上)としてください。

```sql
SELECT 都市名,
       MAX(最高気温) AS 最高気温(30度以上)
FROM 都市別気象観測
GROUP BY 都市名
HAVING MAX(最高気温) >= 30;
```

#### 正解: 11 / 不正解: 6 / 正解率: 65%

### 問題6

都市別で、1年間で最も低い最低気温が0度以下を記録した月のある都市名とその気温。列名は都市名、最低気温(0度以下)としてください。

```sql
SELECT 都市名,
       MIN(最低気温) AS 最低気温(0度以下)
FROM 都市別気象観測
GROUP BY 都市名
HAVING MIN(最低気温) <= 0;
```

#### 正解: 10 / 不正解: 7 / 正解率: 59%

### 問題7

各都市の年間平均気温（最高気温と最低気温の平均の平均）を計算し、列名を都市名と年間平均気温をとして、年間平均気温の降順で表示してください。

```sql
SELECT 都市名,
       AVG((最高気温 + 最低気温) / 2.0) AS 年間平均気温
FROM 都市別気象観測
GROUP BY 都市名
ORDER BY 年間平均気温 DESC;
```

#### 正解: 12 / 不正解: 5 / 正解率: 71%

### 問題8

降水量の合計が最も多かった都市の都市名とその降水量を抽出してください。列名は都市名、降水量としてください。

```sql
SELECT 都市名,
       SUM(降水量) AS 降水量
FROM 都市別気象観測
GROUP BY 都市名
ORDER BY 降水量 DESC
LIMIT 1;
```

#### 正解: 14 / 不正解: 3 / 正解率: 82%

### 問題9

月別に最高気温の平均が25度以上だった月を抽出し、その月と平均最高気温を表示してください。列名は月、平均最高気温とし、月の昇順で表示してください。

```sql
SELECT 月,
       AVG(最高気温) AS 平均最高気温
FROM 都市別気象観測
GROUP BY 月
HAVING AVG(最高気温) >= 25
ORDER BY 月;
```

#### 正解: 11 / 不正解: 6 / 正解率: 65%

### 問題10

都市別に、年間の最高気温と最低気温の差（気温差）を求め、列名を都市名と年間気温差とする。年間気温差の昇順で表示してください。

```sql
SELECT 都市名,
       MAX(最高気温) - MIN(最低気温) AS 年間気温差
FROM 都市別気象観測
GROUP BY 都市名
ORDER BY 年間気温差 ASC;
```

#### 正解: 12 / 不正解: 5 / 正解率: 71%