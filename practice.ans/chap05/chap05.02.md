## 問題

「chap05」データベースの操作に関するSQL文を記述してください

### 問題1

依頼された文字は、何文字の刺繍が必要かを求める。「文字」列のデータをもとに、1つのSQL文で「文字数」列の全行を更新する。ただし、「文字」列には半角の空白が入る可能性があるが、空白は文字数に含めない。なお、使用するDBMSでは、文字列長を得る関数はバイト数ではなく文字数を返すものとする。

```sql
UPDATE 受注 SET 文字数 = CHAR_LENGTH(REPLACE(文字, ' ', ''));
```

#### 正解: 9 / 不正解: 6 / 正解率: 60%

### 問題2

受注内容を一覧表示する。一覧には、受注日、受注ID、文字数、書体名、単価、特別加工料を載せ、受注日および受注ID順に表示したい。ただし、特別加工料がかからないものについては、特別加工料をゼロとする。

```sql
SELECT 受注日, 受注ID, 文字数,
  CASE 書体コード
    WHEN '1' THEN 'ブロック体'
    WHEN '2' THEN '筆記体'
    WHEN '3' THEN '草書体'
    ELSE 'ブロック体'
  END AS 書体名,
  CASE COALESCE(書体コード, '1')
    WHEN '1' THEN 100
    WHEN '2' THEN 150
    WHEN '3' THEN 200
  END AS 単価,
  CASE WHEN 文字数 > 10 THEN 500 ELSE 0 END AS 特別加工料
FROM 受注
ORDER BY 受注日, 受注ID;
```

#### 正解: 8 / 不正解: 7 / 正解率: 53%

### 問題3

受注IDが102、113の注文に対して、文字の一部を変更したいという依頼があった。登録されている文字を次の依頼内容に合わせて更新する。
依頼内容：半角スペースを「★」に変更

```sql
UPDATE 受注 SET 文字 = REPLACE(文字, ' ', '★') WHERE 受注ID IN ('102', '113');
```

#### 正解: 7 / 不正解: 8 / 正解率: 47%

### 問題4

パーティーテーブルから、次の形式の結果表を取得する。
- 職業区分
- 職業コード
- ID
- 名称
職業区分は、物理攻撃の得意なもの（職業コードが1から始まる）を「S」、魔法攻撃の得意なもの（職業コードが2から始まる）を「M」、それ以外を「A」と表示すること。また、職業コード順とすること。

```sql
SELECT
  CASE
    WHEN 職業コード LIKE '1%' THEN 'S'
    WHEN 職業コード LIKE '2%' THEN 'M'
    ELSE 'A'
  END AS 職業区分,
  職業コード, ID, 名称
FROM パーティー
ORDER BY 職業コード;
```

#### 正解: 9 / 不正解: 6 / 正解率: 60%

### 問題5

アイテム「勇気の鈴」を装備すると、HPが50ポイントアップする。このアイテムを装備したときの各キャラクターのHPを適切な列を用いて次の別名で取得する。ただし、このアイテムは「武道家」と「学者」しか装備できない。
- なまえ
- 現在のHP
- 装備後のHP

```sql
SELECT 名称 AS なまえ, HP AS 現在のHP, HP + 50 AS 装備後のHP
FROM パーティー
WHERE 職業コード IN ('11', '21');
```

#### 正解: 4 / 不正解: 11 / 正解率: 27%

### 問題6

ID「A01」と「A03」のキャラクターがアイテム「知恵の指輪」を装備し、MPが20ポイントアップした。その該当データのMPを更新する。

```sql
UPDATE パーティー SET MP = MP + 20 WHERE ID IN ('A01', 'A03');
```

#### 正解: 11 / 不正解: 4 / 正解率: 73%

### 問題7

武道家の技「スッキリパンチ」は、自分のHPを2倍したポイントのダメージを敵に与える。この技を使ったときのダメージを適切な列を用いて次の別名で抽出する。
- なまえ
- 現在のHP
- 予想されるダメージ

```sql
SELECT 名称 AS なまえ, HP AS 現在のHP, HP * 2 AS 予想されるダメージ
FROM パーティー
WHERE 職業コード = '11';
```

#### 正解: 6 / 不正解: 9 / 正解率: 40%

### 問題8

現在、主人公のパーティーにいるキャラクターの状況について、適切な列を用いて次の別名で取得する。
- なまえ
- HPとMP
- ステータス
「HPとMP」はHPとMPを「／」でつなげたものとする。ステータスには状態コードを日本語で置き換えたものを表示するが、ステータスに異常がない場合は、何も表示しない。

```sql
SET sql_mode = 'PIPES_AS_CONCAT';

SELECT 名称 AS なまえ,
  HP || '／' || MP AS HPとMP,
  CASE 状態コード
    WHEN '01' THEN '眠り'
    WHEN '02' THEN '毒'
    WHEN '03' THEN '沈黙'
    WHEN '04' THEN '混乱'
    WHEN '09' THEN '気絶'
    ELSE ''
  END AS ステータス
FROM パーティー;

SELECT 名称 AS なまえ,
  CONCAT(HP, '／', MP) AS HPとMP,
  CASE 状態コード
    WHEN '01' THEN '眠り'
    WHEN '02' THEN '毒'
    WHEN '03' THEN '沈黙'
    WHEN '04' THEN '混乱'
    WHEN '09' THEN '気絶'
    ELSE ''
  END AS ステータス
FROM パーティー;
```


#### 正解: 3 / 不正解: 12 / 正解率: 20%

### 問題9

イベントテーブルから、次の形式の結果表を取得する。
- イベント番号
- イベント名称
- タイプ
- 発生時期

タイプは日本語で置き換え、発生時期は次の条件に応じて表示する。

  - イベント番号が1〜10なら「序盤」
  - イベント番号が11〜17なら「中盤」
  - 上記以外なら「終盤」

```sql
SELECT イベント番号, イベント名称,
  CASE タイプ
    WHEN '1' THEN '強制'
    WHEN '2' THEN 'フリー'
    WHEN '3' THEN '特殊'
  END AS タイプ,
  CASE
    WHEN イベント番号 BETWEEN 1 AND 10 THEN '序盤'
    WHEN イベント番号 BETWEEN 11 AND 17 THEN '中盤'
    ELSE '終盤'
  END AS 発生時期
FROM イベント;
```

#### 正解: 5 / 不正解: 10 / 正解率: 33%

### 問題10

敵の攻撃「ネームバリュー」は、名前の文字数(バイト数ではない)を10倍したポイントのダメージがある。この攻撃を受けたときの各キャラクターの予想ダメージを適切な列を用いて次の別名で取得する。
- なまえ
- 現在のHP
- 予想ダメージ

```sql
SELECT 名称 AS なまえ, HP AS 現在のHP, CHAR_LENGTH(名称) * 10 AS 予想ダメージ
FROM パーティー;
```

#### 正解: 6 / 不正解: 9 / 正解率: 40%